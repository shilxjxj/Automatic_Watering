C51 COMPILER V9.00   MAIN                                                                  04/26/2019 16:23:22 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN ..\bin\main.obj
COMPILER INVOKED BY: D:\keil4\C51\BIN\C51.EXE main.c BROWSE INCDIR(..\inc) DEBUG OBJECTEXTEND OBJECT(..\bin\main.obj)

line level    source

   1          #include "main.h"
   2          #include "LCD12864.h"
   3          
   4          unsigned long HX711_Buffer = 0;
   5          unsigned long Weight_Maopi = 0;
   6          long Weight_Shiwu = 0;
   7          
   8          unsigned char flag = 0;
   9          bit Flag_ERROR = 0;
  10          
  11          //校准参数
  12          //因为不同的传感器特性曲线不是很一致，因此，每一个传感器需要矫正这里这个参数才能使测量值很准确。
  13          //当发现测试出来的重量偏大时，增加该数值。
  14          //如果测试出来的重量偏小时，减小改数值。
  15          //该值可以为小数
  16          #define GapValue 430
  17          
  18          uchar code dis1[] = {"粤嵌众创"};
  19          uchar code dis2[] = {"智能电子称系统"};
  20          uchar code dis3[] = {"物品重量:"};
  21          uchar code dis4[] = {"0123456789"};
  22          uchar code dis5[] = {"超重!"};
  23          uchar code dis6[] = {"未放置物品"};
  24          uchar code src[]={"                "}; //用于清屏
  25          
  26          //****************************************************
  27          //主函数
  28          //****************************************************
  29          void main()
  30          {
  31   1                      lcd_init();
  32   1              
  33   1                      lcd_pos(0,0);
  34   1                      lcd_show(dis1);
  35   1                              
  36   1                      lcd_pos(1,0);
  37   1                      lcd_show(dis2);
  38   1              
  39   1      //              delay(300);              //延时,等待传感器稳定
  40   1      
  41   1              ///Get_Maopi();                         //称毛皮重量
  42   1              
  43   1              while(1)
  44   1              {
  45   2                      EA = 0;
  46   2                      //Get_Weight();                 //称重
  47   2                      EA = 1;
  48   2      
  49   2                      Scan_Key();
  50   2                      
  51   2                      //显示当前重量
  52   2                      if( Flag_ERROR == 1)
  53   2                      {
  54   3                              lcd_pos(3,0);
  55   3                              lcd_show(dis5);
C51 COMPILER V9.00   MAIN                                                                  04/26/2019 16:23:22 PAGE 2   

  56   3                      }               
  57   2                      else
  58   2                      {
  59   3      
  60   3                              lcd_pos(2,0);
  61   3                              lcd_show(dis3);
  62   3                              lcd_wdat(dis4[Weight_Shiwu/1000]);
  63   3                              lcd_wdat(dis4[Weight_Shiwu%1000/100]);
  64   3                              lcd_wdat(dis4[Weight_Shiwu%100/10]);
  65   3                              lcd_wdat(dis4[Weight_Shiwu%10]);
  66   3                              lcd_show("g");  
  67   3      
  68   3                              lcd_pos(3,0);
  69   3                              lcd_show(src);
  70   3                      }
  71   2                      
  72   2              }
  73   1      }
  74          
  75          //扫描按键
  76          void Scan_Key()
  77          {
  78   1              if(KEY1 == 0)
  79   1              {
  80   2                      Delay_ms(5);
  81   2                      if(KEY1 == 0)
  82   2                      {
  83   3                              while(KEY1 == 0);
  84   3                              //Get_Maopi();                  //去皮
  85   3                      }       
  86   2              }
  87   1      }
  88          
  89          //****************************************************
  90          //MS延时函数(12M晶振下测试)
  91          //****************************************************
  92          void Delay_ms(unsigned int n)
  93          {
  94   1              unsigned int  i,j;
  95   1              for(i=0;i<n;i++)
  96   1                      for(j=0;j<123;j++);
  97   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    322    ----
   CONSTANT SIZE    =     81    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     13    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
